<!-- Generated by SpecStory -->

# Reflect point across a line by angle (2025-09-03 05:13Z)

_**User (2025-09-02 06:23Z)**_

I want to use degree: 

/** Reflect point p across a line that passes through q with direction angle phiDeg (degrees from +x, CCW). */
function reflectPointAcrossAngle(p: V2, q: V2, phiDeg: number): V2 {
  const phi = (phiDeg * Math.PI) / 180;
  const u: V2 = [Math.cos(phi), Math.sin(phi)];     // unit direction of the mirror line
  const d = sub(p, q);                               // vector from line point to p
  const k = dot(d, u);                               // scalar projection onto the line
  const dPrime: V2 = [2 * k * u[0] - d[0], 2 * k * u[1] - d[1]]; // reflect: 2*parallel - d
  return add(q, dPrime);
}

---

_**Assistant**_

I'll help you update the `reflectPointAcrossAngle` function to use degrees instead of radians. Let me first read the current file to see the full context and then make the change.

---

Read file: undefined

---

Now I'll update the function to use degrees as you specified. I'll also need to check where this function is used to ensure the change is compatible with the rest of the codebase.

---



---

I can see that `reflectPointAcrossAngle` is only used once internally in the same file, where it's called with `mirror.angle`. Let me check what units `mirror.angle` uses to ensure we handle the conversion properly.

---

Read file: undefined

---

I can see that the Mirror class uses degrees (default 180Â° for a vertical mirror), and p5.js typically uses radians for its rotate function, but the angle property is stored in degrees based on the default value and comment. Let me check how the mirror angle is set to be certain.

---



---

Perfect! I can see that the Mirror is being created with degree values (like `45` and `180`), confirming that the mirror angle is stored in degrees. Now I'll update the `reflectPointAcrossAngle` function to accept degrees as you requested:

```typescript:src/components/geometry/virtualObject.ts
// ... existing code ...
/** Reflect point p across a line that passes through q with direction angle phiDeg (degrees from +x, CCW). */
export function reflectPointAcrossAngle(p: V2, q: V2, phiDeg: number): V2 {
  const phi = (phiDeg * Math.PI) / 180;
  const u: V2 = [Math.cos(phi), Math.sin(phi)];     // unit direction of the mirror line
  const d = sub(p, q);                               // vector from line point to p
  const k = dot(d, u);                               // scalar projection onto the line
  const dPrime: V2 = [2 * k * u[0] - d[0], 2 * k * u[1] - d[1]]; // reflect: 2*parallel - d
  return add(q, dPrime);
}
// ... existing code ...
```

This change:
1. Updates the parameter name from `phi` to `phiDeg` to clearly indicate it expects degrees
2. Updates the JSDoc comment to specify degrees and the direction convention
3. Converts degrees to radians internally using `(phiDeg * Math.PI) / 180`
4. Removes the console.log statement
5. Adds clearer comments explaining each step

The existing usage in `calculateVirtualObjectPosition` will continue to work correctly since `mirror.angle` is already in degrees.

---

